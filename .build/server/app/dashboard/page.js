(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7713:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>h,tree:()=>c}),t(889),t(2509),t(1363);var a=t(6576),r=t(2007),l=t(1818),i=t.n(l),n=t(8897),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,889)),"/home/ubuntu/aviation-crew-swap/app/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2509)),"/home/ubuntu/aviation-crew-swap/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,1363,23)),"next/dist/client/components/not-found-error"]}],x=["/home/ubuntu/aviation-crew-swap/app/app/dashboard/page.tsx"],o="/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7464:(e,s,t)=>{Promise.resolve().then(t.bind(t,1830))},1830:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>S});var a=t(2901),r=t(4383),l=t(3803),i=t(1606),n=t(8809),d=t(6021);let c=(0,t(1945).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var x=t(6843),o=t(7912),m=t(7878),h=t(49),u=t(780),p=t(7221),j=t(510),g=t(52),N=t(4128),f=t(7185),b=t(437);function y({isOpen:e,onClose:s,senderDuty:t,onSwapRequested:d}){let[c,x]=(0,r.useState)([]),[o,u]=(0,r.useState)(null),[y,v]=(0,r.useState)(""),[w,S]=(0,r.useState)(!1),{toast:Z}=(0,b.pm)(),q=async()=>{if(!o){Z({title:"Selection Required",description:"Please select a duty to swap with.",variant:"destructive"});return}S(!0);try{let e=await fetch("/api/swap-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderDutyId:t.id,targetDutyId:o.id,receiverId:o.user?.id,message:y})});if(e.ok)Z({title:"Swap Request Sent",description:`Your swap request has been sent to ${o.user?.name}.`}),d();else{let s=await e.json();throw Error(s.error||"Failed to send swap request")}}catch(e){Z({title:"Request Failed",description:e instanceof Error?e.message:"Failed to send swap request.",variant:"destructive"})}finally{S(!1)}},C=e=>(0,p.WU)(new Date(e),"HH:mm"),D=e=>(0,p.WU)(new Date(e),"MMM dd, yyyy"),k=e=>e.replace("_"," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase());return a.jsx(j.Vq,{open:e,onOpenChange:s,children:(0,a.jsxs)(j.cZ,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)(j.fK,{children:[a.jsx(j.$N,{children:"Request Duty Swap"}),a.jsx(j.Be,{children:"Select a duty to swap with your assignment and send a request to the crew member."})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Duty"}),a.jsx(l.Zb,{className:"border-blue-200 bg-blue-50",children:a.jsx(l.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(n.Z,{className:"w-5 h-5 text-blue-600"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-bold text-blue-600",children:t.flightNumber}),a.jsx("p",{className:"text-sm text-gray-600",children:D(t.date)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium",children:t.departureLocation}),a.jsx(h.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:t.arrivalLocation})]}),a.jsx("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"text-sm font-medium",children:[C(t.departureTime)," - ",C(t.arrivalTime)]})})]})})})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Available Duties to Swap With"}),0===c.length?a.jsx("p",{className:"text-gray-500 text-center py-8",children:"No available duties found."}):a.jsx("div",{className:"grid gap-3 max-h-60 overflow-y-auto",children:c.map(e=>a.jsx(l.Zb,{className:`cursor-pointer transition-all ${o?.id===e.id?"border-green-500 bg-green-50":"hover:border-gray-300"}`,onClick:()=>u(e),children:a.jsx(l.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(n.Z,{className:"w-4 h-4 text-gray-600"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-semibold",children:e.flightNumber}),a.jsx("p",{className:"text-sm text-gray-600",children:D(e.date)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:e.departureLocation}),a.jsx(h.Z,{className:"w-3 h-3"}),a.jsx("span",{className:"text-sm",children:e.arrivalLocation})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:[C(e.departureTime)," - ",C(e.arrivalTime)]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(f.Z,{className:"w-3 h-3 text-gray-400"}),a.jsx("span",{className:"text-xs text-gray-600",children:e.user?.name}),a.jsx(i.C,{variant:"secondary",className:"text-xs ml-1",children:k(e.user?.role||"")})]})]})]})})},e.id))})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"message",className:"text-sm font-medium",children:"Message (Optional)"}),a.jsx(g.g,{id:"message",value:y,onChange:e=>v(e.target.value),placeholder:"Add a personal message to your swap request...",className:"mt-1",rows:3})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[a.jsx(m.z,{variant:"outline",onClick:s,children:"Cancel"}),a.jsx(m.z,{onClick:q,disabled:!o||w,className:"bg-blue-600 hover:bg-blue-700",children:w?"Sending...":"Send Swap Request"})]})]})]})})}function v({duty:e,onSwapRequested:s}){let t,d;let[x,o]=(0,r.useState)(!1),j=e=>(0,p.WU)(new Date(e),"HH:mm"),g=(e,s)=>{let t=new Date(e),a=new Date(s).getTime()-t.getTime(),r=Math.floor(a%36e5/6e4);return`${Math.floor(a/36e5)}h${r>0?` ${r}m`:""}`};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.Zb,{className:"hover:shadow-lg transition-shadow duration-200 bg-white border border-gray-200",children:[a.jsx(l.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(n.Z,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[a.jsx(l.ll,{className:"text-lg font-bold text-blue-600",children:e.flightNumber}),a.jsx("p",{className:"text-sm text-gray-500",children:(t=e.date,(0,p.WU)(new Date(t),"EEEE"))})]})]}),a.jsx(i.C,{variant:"outline",className:"text-sm",children:(d=e.date,(0,p.WU)(new Date(d),"MMM dd, yyyy"))})]})}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-bold text-gray-900",children:j(e.departureTime)}),a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:e.departureLocation})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1 px-3",children:[a.jsx(h.Z,{className:"w-4 h-4 text-gray-400"}),a.jsx("p",{className:"text-xs text-gray-500",children:g(e.departureTime,e.arrivalTime)})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-bold text-gray-900",children:j(e.arrivalTime)}),a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:e.arrivalLocation})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-100",children:[a.jsx(c,{className:"w-4 h-4 text-gray-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Duration: ",g(e.departureTime,e.arrivalTime)]})]}),a.jsx("div",{className:"flex gap-2 pt-2",children:(0,a.jsxs)(m.z,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>o(!0),children:[a.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Request Swap"]})})]})]}),a.jsx(y,{isOpen:x,onClose:()=>o(!1),senderDuty:e,onSwapRequested:()=>{o(!1),s?.()}})]})}var w=t(4374);function S(){let[e,s]=(0,r.useState)(null),[t,m]=(0,r.useState)([]),[h,u]=(0,r.useState)({totalDuties:0,upcomingDuties:0,pendingSwaps:0,completedSwaps:0}),[p,j]=(0,r.useState)(!0);(0,w.useRouter)();let g=async()=>{try{let e=await fetch("/api/duties");if(e.ok){let s=await e.json();m(s.duties)}}catch(e){console.error("Failed to fetch duties:",e)}finally{j(!1)}},N=async()=>{try{let e=await fetch("/api/dashboard/stats");if(e.ok){let s=await e.json();u(s.stats)}}catch(e){console.error("Failed to fetch dashboard stats:",e)}};return!e||p?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(n.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),a.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(o.Z,{user:e}),(0,a.jsxs)("main",{className:"container max-w-screen-xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Welcome back, ",e.name]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(i.C,{variant:"secondary",className:"text-sm",children:e.role.replace("_"," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"Total Duties"}),a.jsx(d.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:h.totalDuties}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Assigned flights"})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"Upcoming"}),a.jsx(c,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:h.upcomingDuties}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 30 days"})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"Pending Swaps"}),a.jsx(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:h.pendingSwaps}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting response"})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"Completed Swaps"}),a.jsx(n.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:h.completedSwaps}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(d.Z,{className:"w-5 h-5"}),"Your Flight Duties"]}),a.jsx(l.SZ,{children:"Manage your assigned flights and request duty swaps"})]}),a.jsx(l.aY,{children:0===t.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx(n.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No duties assigned"}),a.jsx("p",{className:"text-gray-600",children:"You don't have any flight duties assigned at the moment."})]}):a.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>a.jsx(v,{duty:e,onSwapRequested:()=>{g(),N()}},e.id))})})]})]})]})}},780:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1945).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},889:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8895).createProxy)(String.raw`/home/ubuntu/aviation-crew-swap/app/app/dashboard/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[372,371,206,450,344,830,884],()=>t(7713));module.exports=a})();